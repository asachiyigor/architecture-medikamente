# Меры по защите данных компании «Медикаменте»

## 1. Список данных для защиты и способы защиты

### 1.1 Классификация данных по категориям конфиденциальности

| № | Категория данных | Примеры | Уровень конфиденциальности | Способ защиты |
|---|---|---|---|---|
| 1 | **ПДн пациентов (идентификационные)** | ФИО, дата рождения, телефон, email, адрес прописки | Высокий | Шифрование AES-256 (at rest), TLS 1.3 (in transit), RBAC |
| 2 | **Медицинские данные (врачебная тайна)** | Диагнозы, результаты анализов, медицинские карты, назначения, хронические заболевания | Критический | Шифрование AES-256, обезличивание для аналитики, строгий RBAC (только лечащий врач) |
| 3 | **Платёжные данные** | Суммы платежей, реквизиты, данные ККМ, чеки | Высокий | Шифрование, токенизация, маскирование при отображении |
| 4 | **Данные о занятости пациентов** | Место работы/учёбы | Средний | Обфускация, шифрование at rest |
| 5 | **Кадровые данные сотрудников** | ФИО, паспортные данные, ИНН, зарплата, трудовые договоры | Высокий | Шифрование AES-256, RBAC (только бухгалтерия/HR) |
| 6 | **Контрактные данные** | Клиентские контракты, договоры | Средний | Шифрование at rest, RBAC |
| 7 | **Данные учёта ТМЦ** | Остатки, закупки, поставщики | Низкий | Шифрование at rest, базовый контроль доступа |
| 8 | **Бухгалтерские данные** | P&L, налоговая отчётность, начисления | Средний | Шифрование at rest, RBAC (только бухгалтерия) |
| 9 | **Данные аутентификации** | Логины, пароли, токены доступа | Критический | Хеширование (bcrypt/Argon2), MFA, безопасное хранение |
| 10 | **Логи и аудит** | Журналы доступа, действия пользователей | Средний | Шифрование, append-only хранение, ротация |

### 1.2 Детализация способов защиты по категориям

#### Персональные данные пациентов (ПДн)
- **Шифрование:** AES-256 для хранения, TLS 1.3 для передачи
- **Маскирование:** Динамическое маскирование при отображении (показывать И****в вместо Иванов)
- **Обезличивание:** Для аналитических задач и отчётов — псевдонимизация с заменой идентификаторов
- **Контроль доступа:** RBAC — только ресепшен и лечащий врач имеют доступ к ПДн пациента

#### Медицинские данные
- **Шифрование:** AES-256 at rest, TLS 1.3 in transit, шифрование на уровне полей БД
- **Обезличивание:** k-анонимизация для аналитики и ML/BI (удаление прямых идентификаторов, генерализация квази-идентификаторов)
- **Контроль доступа:** ABAC — доступ только у лечащего врача и пациента к его данным; другие врачи — только по запросу с обоснованием
- **Аудит:** Полное логирование каждого обращения к медицинским данным

#### Платёжные данные
- **Токенизация:** Замена реальных платёжных реквизитов токенами
- **Маскирование:** Статическое маскирование номеров карт (**** **** **** 1234)
- **Шифрование:** AES-256 at rest, TLS 1.3 in transit
- **Контроль доступа:** RBAC — только кассиры и бухгалтерия

---

## 2. Механизм тегирования данных

### 2.1 Схема тегирования

Предлагается внедрить систему тегирования данных на базе Apache Atlas (с учётом стека компании — Java, Kubernetes).

#### Уровни тегов:

| Тег | Описание | Пример данных | Требуемые меры |
|---|---|---|---|
| `CONFIDENTIALITY:CRITICAL` | Данные, утечка которых создаёт максимальный ущерб | Медицинские карты, диагнозы, результаты анализов | Шифрование + строгий ABAC + полный аудит + обезличивание для аналитики |
| `CONFIDENTIALITY:HIGH` | Персональные данные, защищённые 152-ФЗ | ФИО, дата рождения, контакты, СНИЛС, платёжные данные | Шифрование + RBAC + аудит |
| `CONFIDENTIALITY:MEDIUM` | Данные с ограниченным доступом | Контракты, бухгалтерия, кадровые данные | Шифрование at rest + RBAC |
| `CONFIDENTIALITY:LOW` | Общедоступные внутри компании | Учёт ТМЦ, расписание, справочники | Базовый контроль доступа |

#### Дополнительные теги:

| Тег | Назначение |
|---|---|
| `PII:TRUE / PII:FALSE` | Признак наличия персональных данных |
| `PHI:TRUE / PHI:FALSE` | Признак наличия медицинских данных (Protected Health Information) |
| `RETENTION:1Y / 5Y / 25Y` | Срок хранения данных |
| `CONSENT_REQUIRED:TRUE` | Требуется явное согласие субъекта на обработку |
| `RIGHT_TO_DELETE:TRUE` | Данные подлежат удалению по запросу субъекта |
| `ANONYMIZABLE:TRUE` | Данные могут быть обезличены для аналитики |

### 2.2 Процесс тегирования

1. **Инвентаризация** — каталогизация всех источников данных (Excel, 1С, общий диск)
2. **Автоматическая классификация** — сканирование данных с помощью Apache Atlas + NLP-модели для выявления ПДн и медицинских данных
3. **Ручная верификация** — Data Steward проверяет и корректирует автоматические теги
4. **Применение политик** — на основе тегов автоматически применяются правила доступа, шифрования и маскирования
5. **Мониторинг** — непрерывный контроль за соблюдением политик на основе тегов

### 2.3 Инструменты тегирования

| Инструмент | Назначение | Обоснование выбора |
|---|---|---|
| **Apache Atlas** | Каталогизация и тегирование метаданных | Open-source, интеграция с Java-стеком, поддержка Kubernetes |
| **Apache NiFi** | Управление потоками данных, автоматическое применение тегов при передаче | Визуальное управление ETL, аудит потоков |
| **PostgreSQL Row-Level Security** | Контроль доступа к данным на уровне строк БД | Уже в стеке компании (Postgres) |
| **HashiCorp Vault** | Управление ключами шифрования и секретами | Интеграция с Kubernetes, поддержка AES-256 |

---

## 3. Список инструментов и мер обеспечения конфиденциальности

### 3.1 Инструменты защиты данных

| Слой защиты | Инструмент/Технология | Назначение |
|---|---|---|
| **Шифрование at rest** | AES-256 (PostgreSQL TDE, LUKS) | Шифрование БД и файловой системы |
| **Шифрование in transit** | TLS 1.3 | Шифрование сетевого трафика |
| **Управление ключами** | HashiCorp Vault | Централизованное управление ключами шифрования |
| **Контроль доступа** | Keycloak (IAM) + RBAC/ABAC | Единая точка аутентификации и авторизации |
| **Маскирование данных** | Dynamic Data Masking (PostgreSQL) | Маскирование при отображении чувствительных полей |
| **Обезличивание** | Apache Spark + k-анонимизация | Обезличивание данных для аналитического слоя |
| **Тегирование** | Apache Atlas | Классификация и тегирование метаданных |
| **Управление потоками** | Apache NiFi | Контроль и аудит потоков данных |
| **Аудит и логирование** | ELK Stack (Elasticsearch + Logstash + Kibana) | Централизованный сбор и анализ логов доступа |
| **Мониторинг и алертинг** | Victoria Metrics + Grafana | Мониторинг метрик безопасности, алерты при аномалиях |
| **DLP (Data Loss Prevention)** | Open-source DLP агент | Предотвращение утечек данных |
| **Бекапирование** | Encrypted backups (pgBackRest) | Шифрованные резервные копии |
| **Consent Management** | Custom-сервис на Java | Управление согласиями пациентов |

### 3.2 Организационные меры

| Мера | Описание |
|---|---|
| **Политика обработки ПДн** | Разработка и внедрение политики обработки персональных данных в соответствии с 152-ФЗ |
| **Назначение DPO** | Назначение ответственного за защиту данных (Data Protection Officer) |
| **Обучение персонала** | Регулярное обучение сотрудников правилам работы с конфиденциальными данными |
| **Регламент доступа** | Документирование процедур предоставления и отзыва доступа к данным |
| **Политика удаления данных** | Определение сроков хранения и процедуры безопасного удаления |
| **Incident Response Plan** | План реагирования на инциденты безопасности |
| **Регулярный аудит** | Периодический аудит соответствия мер защиты требованиям 152-ФЗ |

### 3.3 Матрица ролей и доступа (RBAC)

| Роль | ПДн пациента | Медкарта | Платёжные данные | Кадровые данные | ТМЦ | Бухгалтерия |
|---|---|---|---|---|---|---|
| **Медицинский специалист** | Чтение (свои пациенты) | Чтение/Запись (свои пациенты) | Нет | Нет | Нет | Нет |
| **Ресепшен** | Чтение/Запись | Нет | Нет | Нет | Нет | Нет |
| **Кассир** | Чтение (ФИО) | Нет | Чтение/Запись | Нет | Нет | Нет |
| **Бухгалтер** | Нет | Нет | Чтение | Чтение/Запись | Чтение | Чтение/Запись |
| **Склад** | Нет | Нет | Нет | Нет | Чтение/Запись | Нет |
| **Тех. директор** | Чтение (маскир.) | Нет | Чтение (маскир.) | Чтение (маскир.) | Чтение | Чтение |
| **Администратор сети** | Нет | Нет | Нет | Нет | Нет | Нет |
| **Бизнес-аналитик** | Обезличенные | Обезличенные | Агрегированные | Нет | Чтение | Агрегированные |
| **Пациент (ЛК)** | Свои данные | Своя карта | Свои платежи | Нет | Нет | Нет |
